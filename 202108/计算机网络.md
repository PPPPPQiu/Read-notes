### 网络七层模型  
- 应用层  
- 表示层  
- 会话层  
- 传输层  
- 网络层  
- 数据链路层  
- 物理层  

### 为什么分层  
①隔层之间是独立的

②灵活性好

③结构上可以分隔开

④易于实现和维护

⑤能促进标准化工作。

## 各层协议
物理层：CLOCK、IEEE802.3;中继器，集线器  
数据链路层：PPP、VLAN、MAC；网桥，交换机  
网络层：IP、ICMP、ARP、OSPF、RIP、IGRP；路由器  
传输层：TCP、UDP  
会话层：SQL  
表示层：IPEG、MPEG  
应用层：HTTP、HTTPS、DNS、FTP、DHCP、SMTP、POP3、IMAP  


## 网络层  
### ICMP网际控制报文协议  
- Ping  
- Traceroute  

## 传输层  
### TCP 协议如何保证可靠传输  
- 建立连接    
- 数据校验  
- 流量控制  
- 拥塞控制  
- 超时重传  

### TCP头部  
- 源端口号  
- 目的端口号  
- 序号  
- 确认号  
- 首部长  
- 标志位：ACK FIN SYN  
- 窗口  
- 校验和  

### RST
RST，标识复位，用来异常的关闭连接  
发送rst段关闭连接时，不必等缓冲区的数据都发送出去，直接丢弃缓冲区中的数据。  
而接收端收到rst段后，也不必发送ack来确认。    

- 端口未打开  
- 请求超时  
- 提前关闭  
- 在一个已关闭的socket上收到数据  
- 

### TCP拥塞控制算法  
- 慢开始（cwnd = 1）与拥塞避免（每轮次cwnd加1）  
如果出现了超时，则令 ssthresh = cwnd / 2，然后重新执行慢开始。  
- 快重传与快恢复（ssthresh = cwnd / 2 ，cwnd = ssthresh）  


## 应用层  
### DNS查询方式  
递归：先向该域名的根域服务器查询，再由根域名服务器一级级向下查询。  
迭代：把能解析该域名的其他DNS服务器的IP地址返回给客户端DNS程序  

### DNS负载均衡  
在DNS服务器中为同一个主机名配置多个IP地址,在应答DNS查询时,DNS服务器对每个查询将以DNS文件中主机记录的IP地址按顺序返回不同的解析结果,  
将客户端的访问引导到不同的机器上去,使得不同的客户端访问不同的服务器,从而达到负载均衡的目的｡  
例如可以根据每台机器的负载量，该机器离用户地理位置的距离等等。  


### DNS劫持  
DNS劫持：在DNS服务器中，将www.xxxx.com的域名对应的IP地址进行了变化。你解析出来的域名对应的IP，在劫持前后不一样。  
### HTTP劫持  
HTTP劫持：你DNS解析的域名的IP地址不变。在和网站交互过程中的劫持了你的请求。在网站发给你信息前就给你返回了请求。

### 中间人攻击  
中间人攻击是指攻击者与通讯的两端分别创建独立的联系，并交换其所收到的数据，使通讯的两端认为他们正在通过一个私密的连接与对方 直接对话，但事实上整个会话都被攻击者完全控制。  

在中间人攻 击中，攻击者可以拦截通讯双方的通话并插入新的内容。中间人攻击是一个(缺乏)相互认证的攻击。大多数的加密协议都专门加入了一些特殊的认证方法以阻止中间人攻击。  


中间人攻击过程   
1)客户端发送请求到服务端，请求被中间人截获。  

2)服务器向客户端发送公钥。  

3)中间人截获公钥，保留在自己手上。然后自己生成一个【伪 造的】公钥，发给客户端。  

4)客户端收到伪造的公钥后，生成加密hash值发给服务器。  

5)中间人获得加密hash值，用自己的私钥解密获得真秘钥。同时生成假的加密hash值，发给服务器。  

6)服务器用私钥解密获得假密钥。然后加密数据传输给客户端。  














